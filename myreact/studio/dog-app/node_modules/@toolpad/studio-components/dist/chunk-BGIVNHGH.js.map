{"version":3,"sources":["../src/Image.tsx"],"sourcesContent":["import { Skeleton, SxProps, styled } from '@mui/material';\nimport * as React from 'react';\nimport createBuiltin from './createBuiltin';\nimport { SX_PROP_HELPER_TEXT } from './constants';\nimport ErrorOverlay from './components/ErrorOverlay';\n\nconst ImageRoot = styled('div')({\n  maxWidth: '100%',\n  position: 'relative',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n});\n\nexport interface ImageProps {\n  src: string;\n  alt?: string;\n  sx?: SxProps;\n  width: number;\n  height: number;\n  loading?: boolean;\n  error?: string;\n  fit: 'contain' | 'cover' | 'fill' | 'none' | 'scale-down';\n}\n\nconst Img = styled('img')({\n  width: '100%',\n  height: '100%',\n  position: 'absolute',\n});\n\nfunction Image({\n  sx: sxProp,\n  src,\n  width,\n  height,\n  alt,\n  loading: loadingProp,\n  error: errorProp,\n  fit,\n}: ImageProps) {\n  const sx: SxProps = React.useMemo(() => ({ ...sxProp, width, height }), [sxProp, width, height]);\n\n  const [imgError, setImgError] = React.useState<Error | null>(null);\n  const [imgLoading, setImgLoading] = React.useState(false);\n\n  const handleLoad = React.useCallback(() => {\n    setImgLoading(false);\n  }, []);\n\n  const handleError = React.useCallback(() => {\n    setImgError(new Error(`Failed to load image \"${src}\"`));\n    setImgLoading(false);\n  }, [src]);\n\n  React.useEffect(() => {\n    setImgLoading(true);\n    setImgError(null);\n  }, [src]);\n\n  const loading = loadingProp || imgLoading;\n  const error = errorProp || imgError;\n  return (\n    <ImageRoot sx={sx}>\n      {error ? <ErrorOverlay error={error} /> : null}\n      {loading && !error ? <Skeleton variant=\"rectangular\" width={width} height={height} /> : null}\n      <Img\n        src={src}\n        alt={alt}\n        sx={{\n          objectFit: fit,\n          visibility: loading || error ? 'hidden' : 'visible',\n        }}\n        onLoad={handleLoad}\n        onError={handleError}\n      />\n    </ImageRoot>\n  );\n}\n\nexport default createBuiltin(Image, {\n  helperText: 'The Image component lets you display images.',\n  layoutDirection: 'both',\n  loadingPropSource: ['src'],\n  loadingProp: 'loading',\n  errorProp: 'error',\n  argTypes: {\n    src: {\n      helperText: 'The url of the image. Must resolve to an image file.',\n      type: 'string',\n    },\n    alt: {\n      helperText:\n        \"The `alt` attribute holds a text description of the image. screen readers read this description out to their users so they know what the image means. Alt text is also displayed on the page if the image can't be loaded for some reason: for example, network errors, content blocking, or linkrot.\",\n      type: 'string',\n      default: '',\n    },\n    fit: {\n      helperText:\n        'Defines how the image should [resize](https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit) to its container.',\n      type: 'string',\n      enum: ['contain', 'cover', 'fill', 'none', 'scale-down'],\n      default: 'contain',\n    },\n    width: {\n      helperText: 'The image width in pixels',\n      type: 'number',\n      default: 400,\n    },\n    height: {\n      helperText: 'The image height in pixels',\n      type: 'number',\n      default: 300,\n    },\n    loading: {\n      helperText: 'Displays a loading animation indicating the image is still loading',\n      type: 'boolean',\n      default: false,\n    },\n    sx: {\n      helperText: SX_PROP_HELPER_TEXT,\n      type: 'object',\n    },\n  },\n});\n"],"mappings":";;;;;;;;;;;AAAA,SAAS,UAAmB,cAAc;AAC1C,YAAY,WAAW;AAKvB,IAAM,YAAY,OAAO,KAAK,EAAE;AAAA,EAC9B,UAAU;AAAA,EACV,UAAU;AAAA,EACV,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,gBAAgB;AAClB,CAAC;AAaD,IAAM,MAAM,OAAO,KAAK,EAAE;AAAA,EACxB,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,UAAU;AACZ,CAAC;AAED,SAAS,MAAM;AAAA,EACb,IAAI;AAAA,EACJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,SAAS;AAAA,EACT,OAAO;AAAA,EACP;AACF,GAAe;AACb,QAAM,KAAoB,cAAQ,OAAO,EAAE,GAAG,QAAQ,OAAO,OAAO,IAAI,CAAC,QAAQ,OAAO,MAAM,CAAC;AAE/F,QAAM,CAAC,UAAU,WAAW,IAAU,eAAuB,IAAI;AACjE,QAAM,CAAC,YAAY,aAAa,IAAU,eAAS,KAAK;AAExD,QAAM,aAAmB,kBAAY,MAAM;AACzC,kBAAc,KAAK;AAAA,EACrB,GAAG,CAAC,CAAC;AAEL,QAAM,cAAoB,kBAAY,MAAM;AAC1C,gBAAY,IAAI,MAAM,yBAAyB,GAAG,GAAG,CAAC;AACtD,kBAAc,KAAK;AAAA,EACrB,GAAG,CAAC,GAAG,CAAC;AAER,EAAM,gBAAU,MAAM;AACpB,kBAAc,IAAI;AAClB,gBAAY,IAAI;AAAA,EAClB,GAAG,CAAC,GAAG,CAAC;AAER,QAAM,UAAU,eAAe;AAC/B,QAAM,QAAQ,aAAa;AAC3B,SACE,oCAAC,aAAU,MACR,QAAQ,oCAAC,wBAAa,OAAc,IAAK,MACzC,WAAW,CAAC,QAAQ,oCAAC,YAAS,SAAQ,eAAc,OAAc,QAAgB,IAAK,MACxF;AAAA,IAAC;AAAA;AAAA,MACC;AAAA,MACA;AAAA,MACA,IAAI;AAAA,QACF,WAAW;AAAA,QACX,YAAY,WAAW,QAAQ,WAAW;AAAA,MAC5C;AAAA,MACA,QAAQ;AAAA,MACR,SAAS;AAAA;AAAA,EACX,CACF;AAEJ;AAEA,IAAO,gBAAQ,cAAc,OAAO;AAAA,EAClC,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,mBAAmB,CAAC,KAAK;AAAA,EACzB,aAAa;AAAA,EACb,WAAW;AAAA,EACX,UAAU;AAAA,IACR,KAAK;AAAA,MACH,YAAY;AAAA,MACZ,MAAM;AAAA,IACR;AAAA,IACA,KAAK;AAAA,MACH,YACE;AAAA,MACF,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,IACA,KAAK;AAAA,MACH,YACE;AAAA,MACF,MAAM;AAAA,MACN,MAAM,CAAC,WAAW,SAAS,QAAQ,QAAQ,YAAY;AAAA,MACvD,SAAS;AAAA,IACX;AAAA,IACA,OAAO;AAAA,MACL,YAAY;AAAA,MACZ,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,IACA,QAAQ;AAAA,MACN,YAAY;AAAA,MACZ,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,IACA,SAAS;AAAA,MACP,YAAY;AAAA,MACZ,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,IACA,IAAI;AAAA,MACF,YAAY;AAAA,MACZ,MAAM;AAAA,IACR;AAAA,EACF;AACF,CAAC;","names":[]}